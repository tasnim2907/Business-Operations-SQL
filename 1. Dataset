-- SQL Practice Pack for 25 Questions (MySQL 8.0)
DROP DATABASE IF EXISTS sql_practice_25;
CREATE DATABASE sql_practice_25 CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci;
USE sql_practice_25;

-- Departments
CREATE TABLE departments (
  department_id   INT PRIMARY KEY AUTO_INCREMENT,
  department_name VARCHAR(100) NOT NULL UNIQUE
) ENGINE=InnoDB;
-- Employees (manager chain, salaries, hire dates)
CREATE TABLE employees (
  employee_id     INT PRIMARY KEY AUTO_INCREMENT,
  first_name      VARCHAR(50) NOT NULL,
  last_name       VARCHAR(50) NOT NULL,
  department_id   INT NULL,
  manager_id      INT NULL,
  salary          DECIMAL(12,2) NOT NULL,
  hire_date       DATE NOT NULL,
  FOREIGN KEY (department_id) REFERENCES departments(department_id)
    ON UPDATE CASCADE ON DELETE SET NULL,
  FOREIGN KEY (manager_id) REFERENCES employees(employee_id)
    ON UPDATE CASCADE ON DELETE SET NULL,
  INDEX idx_emp_dept(department_id),
  INDEX idx_emp_mgr(manager_id),
  INDEX idx_emp_salary(salary),
  INDEX idx_emp_hire(hire_date)
) ENGINE=InnoDB;
INSERT INTO departments (department_name) VALUES ('Executive'), ('Engineering'), ('Sales'), ('HR'), ('Support'), ('Finance'), ('Analytics');
INSERT INTO employees (first_name,last_name,department_id,manager_id,salary,hire_date) VALUES
('Ava','Stone',1,NULL,180000.00,'2022-01-10'),
('Alex','Ng',2,1,140000.00,'2022-02-01'),
('Sam','Khan',3,1,130000.00,'2022-03-01'),
('Jamie','Roy',4,1,120000.00,'2022-04-01'),
('Jordan','Kim',5,1,115000.00,'2022-05-01'),
('Taylor','Chen',6,1,125000.00,'2022-06-01'),
('Morgan','Patel',7,1,135000.00,'2022-07-01'),
('Lee','Garcia',2,2,77637.64,'2022-04-09'),
('Jamie','Clark',2,2,56589.10,'2025-04-08'),
('Sam','Harris',2,2,65028.87,'2022-06-26'),
('Reese','Moore',2,2,54889.88,'2022-07-05'),
('Rowan','Moore',2,2,54137.74,'2025-03-04'),
('Jordan','Martinez',2,2,94143.81,'2025-04-08'),
('Sam','Lewis',2,2,90987.90,'2022-04-12'),
('Casey','Johnson',2,2,88966.54,'2022-09-30'),
('Dana','Moore',3,3,60097.86,'2022-08-30'),
('Skye','Wilson',3,3,89218.01,'2023-01-06'),
('Jordan','Lewis',3,3,89984.31,'2023-01-20'),
('Avery','Lee',3,3,88342.11,'2022-05-09'),
('Skye','Johnson',3,3,93330.67,'2024-10-13'),
('Olivia','Clark',3,3,79931.46,'2023-10-06'),
('Sydney','Lewis',3,3,114640.90,'2024-01-11'),
('Dana','Martinez',3,3,105606.56,'2023-05-15'),
('Jamie','Lewis',4,4,71017.44,'2024-10-10'),
('Isabella','Anderson',4,4,101061.17,'2023-08-13'),
('Hayden','Brown',4,4,58264.60,'2024-05-06'),
('Morgan','Anderson',4,4,60638.92,'2024-09-28'),
('Reese','Johnson',4,4,117341.34,'2022-06-08'),
('Ethan','Clark',4,4,90111.82,'2023-10-05'),
('Lee','Thomas',4,4,91605.89,'2025-04-02'),
('Ava','Jackson',4,4,54813.41,'2022-07-11'),
('Kris','White',5,5,98792.94,'2022-05-14'),
('Sam','Wilson',5,5,95299.02,'2024-07-01'),
('Dana','Taylor',5,5,112092.82,'2023-12-12'),
('Alex','Jackson',5,5,74882.49,'2025-06-05'),
('Jordan','White',5,5,54126.81,'2023-08-12'),
('Taylor','Martinez',5,5,77852.84,'2024-10-13'),
('Jamie','Miller',5,5,81443.12,'2025-01-30'),
('Kris','Garcia',5,5,107349.59,'2025-01-31'),
('Kris','Moore',6,6,119052.70,'2024-02-19'),
('Casey','Garcia',6,6,55808.93,'2022-11-06'),
('Casey','Martinez',6,6,50844.41,'2025-04-21'),
('Morgan','Lopez',6,6,69735.15,'2022-10-26'),
('Reese','Clark',6,6,75847.75,'2025-03-05'),
('Lee','Garcia',6,6,98334.56,'2024-11-21'),
('Hayden','Johnson',6,6,81965.06,'2025-02-19'),
('Cameron','Taylor',6,6,77928.52,'2022-08-01'),
('Quinn','Taylor',7,7,54357.35,'2022-05-18'),
('Riley','Jackson',7,7,61361.22,'2023-11-28'),
('Hayden','Johnson',7,7,57166.57,'2025-03-06'),
('Taylor','Clark',7,7,57102.51,'2024-01-15'),
('Hayden','Smith',7,7,54922.09,'2023-03-02'),
('Hayden','Taylor',7,7,60398.53,'2023-06-01'),
('Avery','Young',7,7,75491.44,'2022-09-09'),
('Jordan','White',7,7,119517.19,'2024-08-12'),
('Rowan','Green',NULL,4,65000.00,'2023-05-12'),
('Skye','Blue',NULL,2,72000.00,'2024-03-18');
-- Salary history (for LAG/diff)
CREATE TABLE salary_history (
  id           INT PRIMARY KEY AUTO_INCREMENT,
  employee_id  INT NOT NULL,
  change_date  DATE NOT NULL,
  salary       DECIMAL(12,2) NOT NULL,
  FOREIGN KEY (employee_id) REFERENCES employees(employee_id)
    ON UPDATE CASCADE ON DELETE CASCADE,
  INDEX idx_sh_emp_date(employee_id, change_date)
) ENGINE=InnoDB;
INSERT INTO salary_history (employee_id, change_date, salary) VALUES
(1,'2023-01-01',81483),
(1,'2024-01-01',85557),
(1,'2025-01-01',89631),
(2,'2023-01-01',55628),
(2,'2024-01-01',58409),
(2,'2025-01-01',61190),
(3,'2023-01-01',99130),
(3,'2024-01-01',104086),
(3,'2025-01-01',109043),
(4,'2023-01-01',67351),
(4,'2024-01-01',70718),
(4,'2025-01-01',74086),
(5,'2023-01-01',95354),
(5,'2024-01-01',100121),
(5,'2025-01-01',104889),
(6,'2023-01-01',51513),
(6,'2024-01-01',54088),
(6,'2025-01-01',56664),
(7,'2023-01-01',84619),
(7,'2024-01-01',88849),
(7,'2025-01-01',93080),
(8,'2023-01-01',95224),
(8,'2024-01-01',99985),
(8,'2025-01-01',104746),
(9,'2023-01-01',51772),
(9,'2024-01-01',54360),
(10,'2023-01-01',69535),
(10,'2024-01-01',73011),
(11,'2023-01-01',55964),
(11,'2024-01-01',58762),
(11,'2025-01-01',61560),
(12,'2023-01-01',67112),
(12,'2024-01-01',70467),
(12,'2025-01-01',73823),
(13,'2023-01-01',60947),
(13,'2024-01-01',63994),
(13,'2025-01-01',67041),
(14,'2023-01-01',64600),
(14,'2024-01-01',67830),
(14,'2025-01-01',71060),
(15,'2023-01-01',82944),
(15,'2024-01-01',87091),
(15,'2025-01-01',91238),
(16,'2023-01-01',64617),
(16,'2024-01-01',67847),
(16,'2025-01-01',71078),
(17,'2023-01-01',99697),
(17,'2024-01-01',104681),
(18,'2023-01-01',65688),
(18,'2024-01-01',68972),
(19,'2023-01-01',98488),
(19,'2024-01-01',103412),
(20,'2023-01-01',63101),
(20,'2024-01-01',66256),
(20,'2025-01-01',69411);
-- Users (for login streaks)
CREATE TABLE users (
  user_id    INT PRIMARY KEY AUTO_INCREMENT,
  user_name  VARCHAR(100) NOT NULL UNIQUE
) ENGINE=InnoDB;
-- Daily logins
CREATE TABLE user_logins (
  login_id   INT PRIMARY KEY AUTO_INCREMENT,
  user_id    INT NOT NULL,
  login_date DATE NOT NULL,
  FOREIGN KEY (user_id) REFERENCES users(user_id)
    ON UPDATE CASCADE ON DELETE CASCADE,
  UNIQUE KEY uk_user_date(user_id, login_date)
) ENGINE=InnoDB;
INSERT INTO users (user_name) VALUES ('user_1'), ('user_2'), ('user_3'), ('user_4'), ('user_5'), ('user_6'), ('user_7'), ('user_8'), ('user_9'), ('user_10'), ('user_11'), ('user_12'), ('user_13'), ('user_14'), ('user_15');
INSERT INTO user_logins (user_id, login_date) VALUES
(1,'2025-01-01'),
(1,'2025-01-03'),
(1,'2025-01-04'),
(1,'2025-01-05'),
(1,'2025-01-10'),
(1,'2025-01-11'),
(1,'2025-01-12'),
(1,'2025-01-15'),
(1,'2025-01-16'),
(1,'2025-01-17'),
(1,'2025-01-18'),
(1,'2025-01-19'),
(1,'2025-01-23'),
(1,'2025-01-24'),
(1,'2025-01-25'),
(1,'2025-01-26'),
(1,'2025-01-30'),
(1,'2025-01-31'),
(1,'2025-02-01'),
(2,'2025-01-01'),
(2,'2025-01-04'),
(2,'2025-01-05'),
(2,'2025-01-06'),
(2,'2025-01-07'),
(2,'2025-01-10'),
(2,'2025-01-11'),
(2,'2025-01-12'),
(2,'2025-01-15'),
(2,'2025-01-16'),
(2,'2025-01-17'),
(2,'2025-01-18'),
(2,'2025-01-20'),
(2,'2025-01-21'),
(2,'2025-01-22'),
(2,'2025-01-23'),
(3,'2025-01-01'),
(3,'2025-01-06'),
(3,'2025-01-07'),
(3,'2025-01-12'),
(3,'2025-01-13'),
(3,'2025-01-18'),
(3,'2025-01-19'),
(3,'2025-01-20'),
(4,'2025-01-01'),
(4,'2025-01-02'),
(4,'2025-01-03'),
(4,'2025-01-04'),
(4,'2025-01-09'),
(4,'2025-01-12'),
(4,'2025-01-13'),
(4,'2025-01-16'),
(4,'2025-01-19'),
(4,'2025-01-20'),
(4,'2025-01-21'),
(4,'2025-01-22'),
(4,'2025-01-23'),
(4,'2025-01-28'),
(4,'2025-01-29'),
(4,'2025-02-03'),
(4,'2025-02-04'),
(4,'2025-02-05'),
(5,'2025-01-01'),
(5,'2025-01-03'),
(5,'2025-01-06'),
(5,'2025-01-07'),
(5,'2025-01-08'),
(5,'2025-01-09'),
(5,'2025-01-12'),
(5,'2025-01-13'),
(5,'2025-01-15'),
(5,'2025-01-16'),
(5,'2025-01-17'),
(6,'2025-01-01'),
(6,'2025-01-02'),
(6,'2025-01-03'),
(6,'2025-01-04'),
(6,'2025-01-05'),
(6,'2025-01-08'),
(6,'2025-01-09'),
(6,'2025-01-10'),
(6,'2025-01-11'),
(6,'2025-01-12'),
(6,'2025-01-16'),
(6,'2025-01-17'),
(6,'2025-01-18'),
(6,'2025-01-23'),
(6,'2025-01-24'),
(6,'2025-01-26'),
(6,'2025-01-27'),
(6,'2025-01-28'),
(6,'2025-02-02'),
(6,'2025-02-03'),
(6,'2025-02-04'),
(6,'2025-02-05'),
(6,'2025-02-06'),
(7,'2025-01-01'),
(7,'2025-01-02'),
(7,'2025-01-03'),
(7,'2025-01-04'),
(7,'2025-01-05');
-- Sequence numbers demo (with gaps)
CREATE TABLE sequence_numbers (
  n INT PRIMARY KEY
) ENGINE=InnoDB;
INSERT INTO sequence_numbers (n) VALUES (1), (2), (3), (5), (6), (10), (11), (12), (15), (20), (21), (22), (23), (30), (31), (33), (34), (35), (40), (41), (42);
-- Two comparable tables (same structure)
CREATE TABLE table_a (
  id    INT PRIMARY KEY,
  col1  VARCHAR(50),
  col2  INT,
  col3  DATE
) ENGINE=InnoDB;
CREATE TABLE table_b (
  id    INT PRIMARY KEY,
  col1  VARCHAR(50),
  col2  INT,
  col3  DATE
) ENGINE=InnoDB;
INSERT INTO table_a (id,col1,col2,col3) VALUES (1,'alpha',10,'2024-01-01'), (2,'beta',20,'2024-02-01'), (3,'gamma',30,'2024-03-01'), (4,'delta',40,'2024-04-01'), (5,'epsilon',50,'2024-05-01'), (6,'zeta',60,'2024-06-01'), (7,'eta',70,'2024-07-01'), (8,'theta',80,'2024-08-01'), (9,'iota',90,'2024-09-01'), (10,'kappa',100,'2024-10-01');
INSERT INTO table_b (id,col1,col2,col3) VALUES (1,'alpha',10,'2024-01-01'), (2,'beta',999,'2024-02-02'), (3,'GAMMA',30,'2024-03-01'), (4,'delta',40,'2024-04-01'), (5,'epsilon',51,'2024-05-02'), (6,'zeta',60,'2024-06-01'), (7,'eta',70,'2024-07-02'), (11,'lambda',110,'2024-11-01'), (12,'mu',120,'2024-12-01'), (9,'iota',90,'2024-09-01');
-- Customers
CREATE TABLE customers (
  customer_id   INT PRIMARY KEY AUTO_INCREMENT,
  customer_name VARCHAR(100) NOT NULL,
  email         VARCHAR(150) NULL UNIQUE
) ENGINE=InnoDB;
-- Orders
CREATE TABLE orders (
  order_id     INT PRIMARY KEY AUTO_INCREMENT,
  customer_id  INT NOT NULL,
  order_date   DATE NOT NULL,
  amount       DECIMAL(10,2) NOT NULL,
  status       ENUM('Pending','Completed','Cancelled') NOT NULL DEFAULT 'Completed',
  payment_method ENUM('Card','Cash','PayPal') NOT NULL DEFAULT 'Card',
  FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
    ON UPDATE CASCADE ON DELETE CASCADE,
  INDEX idx_orders_cust_date(customer_id, order_date)
) ENGINE=InnoDB;
INSERT INTO customers (customer_name,email) VALUES ('Customer_1','c1@mail.com'), ('Customer_2','c2@mail.com'), ('Customer_3','c3@mail.com'), ('Customer_4','c4@mail.com'), ('Customer_5','c5@mail.com'), ('Customer_6','c6@mail.com'), ('Customer_7','c7@mail.com'), ('Customer_8','c8@mail.com'), ('Customer_9','c9@mail.com'), ('Customer_10','c10@mail.com'), ('Customer_11','c11@mail.com'), ('Customer_12','c12@mail.com'), ('Customer_13','c13@mail.com'), ('Customer_14','c14@mail.com'), ('Customer_15','c15@mail.com'), ('Customer_16','c16@mail.com'), ('Customer_17','c17@mail.com'), ('Customer_18','c18@mail.com'), ('Customer_19','c19@mail.com'), ('Customer_20','c20@mail.com'), ('Customer_21','c21@mail.com'), ('Customer_22','c22@mail.com'), ('Customer_23','c23@mail.com'), ('Customer_24','c24@mail.com'), ('Customer_25','c25@mail.com'), ('Customer_26','c26@mail.com'), ('Customer_27','c27@mail.com'), ('Customer_28','c28@mail.com'), ('Customer_29','c29@mail.com'), ('Customer_30','c30@mail.com');
INSERT INTO orders (customer_id,order_date,amount,status,payment_method) VALUES
(29,'2023-03-16',141.77,'Pending','PayPal'),
(3,'2025-03-31',137.67,'Cancelled','Card'),
(3,'2023-09-28',432.76,'Completed','Card'),
(11,'2024-07-20',214.7,'Completed','PayPal'),
(5,'2023-02-14',268.19,'Pending','Card'),
(6,'2023-09-26',34.69,'Pending','Cash'),
(21,'2023-11-09',270.23,'Pending','Cash'),
(15,'2024-05-27',339.36,'Completed','Cash'),
(26,'2023-01-19',497.3,'Pending','Card'),
(1,'2025-01-20',257.77,'Pending','PayPal'),
(16,'2023-09-09',467.97,'Pending','PayPal'),
(27,'2024-10-27',221.77,'Completed','PayPal'),
(27,'2025-06-29',202.61,'Cancelled','Cash'),
(23,'2023-08-09',491.4,'Completed','Card'),
(27,'2025-06-22',356.3,'Cancelled','Card'),
(13,'2023-12-22',491.12,'Pending','Card'),
(3,'2024-10-02',373.04,'Completed','Cash'),
(6,'2023-02-26',51.4,'Completed','PayPal'),
(22,'2023-10-16',303.4,'Cancelled','Cash'),
(2,'2024-04-15',100.82,'Completed','Cash'),
(1,'2023-09-27',188.43,'Completed','PayPal'),
(11,'2023-09-08',26.88,'Completed','Card'),
(12,'2023-07-07',10.52,'Completed','Card'),
(16,'2023-10-13',256.35,'Pending','Card'),
(17,'2025-03-05',12.43,'Completed','Card'),
(5,'2024-02-14',297.53,'Completed','Card'),
(10,'2023-11-08',318.54,'Pending','PayPal'),
(17,'2025-05-23',377.76,'Cancelled','PayPal'),
(26,'2025-06-19',302.31,'Completed','PayPal'),
(16,'2023-06-03',149.25,'Cancelled','PayPal'),
(5,'2023-02-14',414.18,'Cancelled','PayPal'),
(21,'2024-03-15',369.59,'Cancelled','Card'),
(30,'2024-06-20',378.9,'Cancelled','Card'),
(27,'2024-12-03',296.19,'Cancelled','PayPal'),
(23,'2024-10-20',122.67,'Pending','Card'),
(5,'2024-10-14',186.75,'Pending','Cash'),
(27,'2024-04-07',283.68,'Cancelled','Card'),
(21,'2024-06-28',343.53,'Completed','Cash'),
(1,'2024-04-12',400.87,'Cancelled','PayPal'),
(29,'2024-07-02',55.05,'Cancelled','Card'),
(24,'2025-01-24',242.19,'Pending','Cash'),
(8,'2025-01-16',380.66,'Pending','PayPal'),
(21,'2024-04-16',252.03,'Completed','Card'),
(16,'2025-07-21',345.01,'Pending','PayPal'),
(21,'2024-10-20',107.16,'Cancelled','Card'),
(11,'2023-09-18',329.25,'Cancelled','Cash'),
(20,'2024-08-04',75.39,'Completed','Card'),
(16,'2023-10-03',486.53,'Pending','PayPal'),
(7,'2024-11-22',249.91,'Cancelled','PayPal'),
(10,'2024-04-20',238.29,'Pending','PayPal'),
(7,'2023-11-16',489.28,'Completed','Card'),
(10,'2024-04-14',47.47,'Cancelled','Cash'),
(9,'2024-02-01',112.82,'Pending','Card'),
(19,'2023-04-03',79.45,'Cancelled','Cash'),
(12,'2023-05-16',305.65,'Cancelled','PayPal'),
(9,'2025-06-27',65.21,'Completed','Card'),
(16,'2025-07-08',439.31,'Completed','Card'),
(6,'2023-01-04',475.48,'Cancelled','Cash'),
(13,'2023-11-06',366.32,'Completed','Cash'),
(13,'2023-11-20',69.25,'Completed','Card'),
(11,'2025-02-07',175.75,'Completed','Card'),
(30,'2023-07-20',359.38,'Cancelled','Cash'),
(9,'2024-01-17',41.84,'Completed','PayPal'),
(3,'2024-01-05',463.45,'Completed','Card'),
(9,'2023-04-15',35.29,'Cancelled','Cash'),
(21,'2025-08-16',82.97,'Completed','Cash'),
(17,'2023-11-20',103.03,'Completed','Cash'),
(29,'2023-01-30',407.86,'Cancelled','Cash'),
(30,'2025-06-15',470.94,'Cancelled','Card'),
(24,'2023-03-24',34.24,'Cancelled','Cash');
-- Bookings (for overlaps & date differences)
CREATE TABLE bookings (
  booking_id   INT PRIMARY KEY AUTO_INCREMENT,
  customer_id  INT NOT NULL,
  start_date   DATE NOT NULL,
  end_date     DATE NOT NULL,
  resource     VARCHAR(50) NOT NULL,
  FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
    ON UPDATE CASCADE ON DELETE CASCADE,
  INDEX idx_book_res(resource),
  INDEX idx_book_period(start_date,end_date)
) ENGINE=InnoDB;
INSERT INTO bookings (customer_id,start_date,end_date,resource) VALUES
(15,'2024-06-06','2024-06-09','Room-C'),
(10,'2024-05-04','2024-05-05','Room-C'),
(5,'2024-02-13','2024-02-21','Room-B'),
(11,'2024-03-13','2024-03-18','Room-B'),
(9,'2024-04-13','2024-04-17','Room-B'),
(16,'2024-05-22','2024-05-29','Room-A'),
(6,'2024-06-13','2024-06-16','Room-A'),
(7,'2024-05-08','2024-05-16','Room-C'),
(8,'2024-04-25','2024-05-01','Room-B'),
(14,'2024-02-05','2024-02-14','Room-A'),
(8,'2024-01-24','2024-01-27','Room-B'),
(18,'2024-01-24','2024-01-30','Room-A'),
(12,'2024-03-07','2024-03-17','Room-A'),
(1,'2024-04-15','2024-04-22','Room-B'),
(17,'2024-02-23','2024-03-01','Room-B'),
(11,'2024-01-16','2024-01-24','Room-B'),
(19,'2024-04-02','2024-04-05','Room-C'),
(17,'2024-05-15','2024-05-19','Room-A'),
(9,'2024-03-04','2024-03-11','Room-B'),
(15,'2024-04-20','2024-04-25','Room-A'),
(5,'2024-01-09','2024-01-16','Room-C'),
(16,'2024-05-30','2024-06-07','Room-A'),
(3,'2024-04-10','2024-04-19','Room-B'),
(15,'2024-03-04','2024-03-06','Room-A');
-- Duplicates demo table
CREATE TABLE duplicates_demo (
  id    INT,
  col1  VARCHAR(50),
  col2  INT
) ENGINE=InnoDB;
INSERT INTO duplicates_demo (id,col1,col2) VALUES (1,'x',10), (2,'y',20), (2,'y',20), (3,'z',30), (4,'z',30), (4,'z',30), (5,'a',10), (5,'a',10);
